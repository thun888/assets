"use strict";(self.webpackChunkblessing_skin_server=self.webpackChunkblessing_skin_server||[]).push([[403],{3291:function(e,s,t){var n=t(5893);t(7294),s.Z=e=>(0,n.jsx)("a",Object.assign({href:"#",title:e.title,className:"ml-2",onClick:e.onClick},{children:(0,n.jsx)("i",{className:"fas fa-edit"},void 0)}),void 0)},6309:function(e,s,t){var n=t(5893),a=(t(7294),t(88));s.Z=()=>(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsx)("div",Object.assign({className:"card-header"},{children:(0,n.jsx)("div",Object.assign({className:"d-flex justify-content-between"},{children:(0,n.jsx)("h3",Object.assign({className:"card-title"},{children:(0,n.jsx)("span",{children:(0,a.t)("general.texturePreview")},void 0)}),void 0)}),void 0)}),void 0),(0,n.jsx)("div",{className:"card-body"},void 0)]}),void 0)},9341:function(e,s,t){t.d(s,{Z:function(){return a}});var n=t(7294);function a(e,s){const[t,a]=(0,n.useState)(s);return(0,n.useEffect)((()=>{a(blessing.extra[e])}),[e]),t}},9018:function(e,s,t){t.d(s,{Z:function(){return i}});var n=t(7294),a=t(3601);function i(){(0,n.useEffect)((()=>{(0,a.j)("mounted")}),[])}},9683:function(e,s,t){t.d(s,{Z:function(){return a}});var n=t(7294);function a(e){const s=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const t=document.querySelector(e),n=document.createElement("div");return s.current=n,t.appendChild(n),()=>{t.removeChild(n),s.current=null}}),[e]),s.current}},7109:function(e,s,t){var n,a;t.d(s,{P:function(){return n},N:function(){return a}}),function(e){e[e.Banned=-1]="Banned",e[e.Normal=0]="Normal",e[e.Admin=1]="Admin",e[e.SuperAdmin=2]="SuperAdmin"}(n||(n={})),function(e){e.Steve="steve",e.Alex="alex",e.Cape="cape"}(a||(a={}))},6051:function(e,s,t){t.d(s,{G:function(){return a},b:function(){return i}});var n=t(917);const a=n.iv`
  cursor: pointer;
`,i=n.iv`
  display: flex;
  justify-content: center;
  align-items: center;
`},403:function(e,s,t){t.r(s),t.d(s,{default:function(){return R}});var n=t(5893),a=t(7294),i=t(1570),r=t(9341),c=t(9018),l=t(6703),d=t(7109);function o(){const[e,s]=(0,a.useState)(0),[t,n]=(0,a.useState)(""),[i,r]=(0,a.useState)(d.N.Steve);return(0,a.useEffect)((()=>{e<=0?n(""):(async()=>{const{hash:s,type:t}=await l.U2(`/skinlib/info/${e}`);n(`${blessing.base_url}/textures/${s}`),r(t)})()}),[e]),[{url:t,type:i},s]}var u=t(88),v=t(2065),h=t(8848),j=t(5944),p=t(917),m=t(3291),x=t(6051),g=e=>{const{player:s}=e,t=e.selected&&p.iv`
      background: #efefef;
      .dark-mode & {
        background: var(--dark);
      }
    `;return(0,j.BX)("tr",Object.assign({css:[x.G,t],onClick:e.onClick},{children:[(0,j.tZ)("td",{children:s.pid},void 0),(0,j.BX)("td",{children:[(0,j.tZ)("span",{children:s.name},void 0),(0,j.tZ)(m.Z,{title:(0,u.t)("user.player.edit-pname"),onClick:()=>{e.onEditName(s)}},void 0)]},void 0),(0,j.BX)("td",Object.assign({className:"d-flex"},{children:[(0,j.tZ)("button",Object.assign({className:"btn btn-warning",onClick:e.onReset},{children:(0,u.t)("user.player.delete-texture")}),void 0),(0,j.tZ)("button",Object.assign({className:"btn btn-danger ml-2",onClick:()=>{e.onDelete(s)}},{children:(0,u.t)("user.player.delete-player")}),void 0)]}),void 0)]}),void 0)},b=t(786),f=t(1655);const y=b.Z.tr`
  height: 64px;
`,N=(0,b.Z)(f.ZP)`
  line-height: 2;
`;var k=()=>(0,n.jsx)(y,{children:(0,n.jsx)("td",Object.assign({colSpan:3},{children:(0,n.jsx)(N,{},void 0)}),void 0)},void 0),O=t(9060),w=t(9683),C=t(6309);const S=b.Z.div`
  display: flex;
  justify-content: space-between;
  width: 80%;

  img {
    max-height: 64px;
    width: 64px;
  }
`;var Z=e=>(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsx)("div",Object.assign({className:"card-header"},{children:(0,n.jsx)("h3",Object.assign({className:"card-title"},{children:(0,u.t)("general.texturePreview")}),void 0)}),void 0),(0,n.jsxs)("div",Object.assign({className:"card-body"},{children:[(0,n.jsxs)(S,Object.assign({className:"mb-5"},{children:[(0,n.jsx)("span",{children:(0,u.t)("general.skin")},void 0),e.skin?(0,n.jsx)("img",{src:e.skin,alt:(0,u.t)("general.skin")},void 0):(0,n.jsx)("span",{children:(0,u.t)("user.player.texture-empty")},void 0)]}),void 0),(0,n.jsxs)(S,Object.assign({className:"mt-5"},{children:[(0,n.jsx)("span",{children:(0,u.t)("general.cape")},void 0),e.cape?(0,n.jsx)("img",{src:e.cape,alt:(0,u.t)("general.cape")},void 0):(0,n.jsx)("span",{children:(0,u.t)("user.player.texture-empty")},void 0)]}),void 0)]}),void 0),(0,n.jsx)("div",Object.assign({className:"card-footer"},{children:e.children}),void 0)]}),void 0);const A=a.lazy((()=>Promise.all([t.e(16),t.e(846)]).then(t.bind(t,1997))));var P=e=>{const[s,t]=(0,a.useState)(!0),i=(0,w.Z)("#previewer"),r=(0,n.jsx)("button",Object.assign({className:"btn btn-default",onClick:()=>t((e=>!e))},{children:s?(0,u.t)("user.switch2dPreview"):(0,u.t)("user.switch3dPreview")}),void 0),{skin:c,cape:l,isAlex:d}=e;return i&&O.createPortal(s?(0,n.jsx)(a.Suspense,Object.assign({fallback:(0,n.jsx)(C.Z,{},void 0)},{children:(0,n.jsx)(A,Object.assign({skin:c,cape:l,isAlex:d},{children:r}),void 0)}),void 0):(0,n.jsx)(Z,Object.assign({skin:c,cape:l},{children:r}),void 0),i)},_=t(7073),E=e=>{const[s,t]=(0,a.useState)(""),{score:i,cost:r,rule:c,length:d}=blessing.extra,o=i>=r;return(0,n.jsxs)(_.Z,Object.assign({show:e.show,title:(0,u.t)("user.player.add-player"),onConfirm:async()=>{const{code:t,message:n,data:a}=await l.v_(h.Z.user.player.add(),{name:s});0===t?(v.A.success(n),e.onAdd(a)):v.A.error(n)},onClose:()=>{t(""),e.onClose()}},{children:[(0,n.jsxs)("div",Object.assign({className:"form-group"},{children:[(0,n.jsx)("label",Object.assign({htmlFor:"new-player-name"},{children:(0,u.t)("general.player.player-name")}),void 0),(0,n.jsx)("input",{type:"text",className:"form-control",id:"new-player-name",value:s,onChange:e=>{t(e.target.value)}},void 0)]}),void 0),(0,n.jsx)("div",Object.assign({className:"callout callout-info"},{children:(0,n.jsxs)("ul",Object.assign({className:"m-0 p-0 pl-3"},{children:[(0,n.jsx)("li",{children:c},void 0),(0,n.jsx)("li",{children:d},void 0)]}),void 0)}),void 0),(0,n.jsxs)("div",Object.assign({className:"alert alert-"+(o?"success":"danger"),role:"alert"},{children:[(0,n.jsx)("i",{className:"icon fas fa-"+(o?"check":"times")},void 0),(0,n.jsxs)("span",Object.assign({className:"ml-1"},{children:[(0,u.t)("user.cur-score")," ",i]}),void 0)]}),void 0)]}),void 0)},B=e=>{const[s,t]=(0,a.useState)(!1),[i,r]=(0,a.useState)(!1);return(0,n.jsxs)(_.Z,Object.assign({show:e.show,title:(0,u.t)("user.chooseClearTexture"),onConfirm:()=>{e.onSubmit(s,i)},onClose:()=>{t(!1),r(!1),e.onClose()}},{children:[(0,n.jsxs)("label",Object.assign({className:"d-block"},{children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:s,onChange:e=>{t(e.target.checked)}},void 0),(0,u.t)("general.skin")]}),void 0),(0,n.jsxs)("label",Object.assign({className:"d-block"},{children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:i,onChange:e=>{r(e.target.checked)}},void 0),(0,u.t)("general.cape")]}),void 0)]}),void 0)},R=(0,i.w)((()=>{const[e,s]=(0,a.useState)([]),[t,i]=(0,a.useState)(!0),[j,p]=(0,a.useState)(0),[m,x]=o(),[b,f]=o(),[y,N]=(0,a.useState)(""),[O,w]=(0,a.useState)(!1),[C,S]=(0,a.useState)(!1),Z=(0,r.Z)("count");(0,c.Z)();const A=e=>{p(e.pid),x(e.tid_skin),f(e.tid_cape)};(0,a.useEffect)((()=>{(async()=>{i(!0);const e=await l.U2("/user/player/list");s(e),1===e.length&&A(e[0]),i(!1)})()}),[]);const _=async e=>{try{await(0,v.K)({title:(0,u.t)("user.deletePlayer"),text:(0,u.t)("user.deletePlayerNotice"),okButtonType:"danger"})}catch(e){return}const{code:t,message:n}=await l.IV(h.Z.user.player.delete(e.pid));if(0===t){v.A.success(n);const{pid:t}=e;s((e=>e.filter((e=>e.pid!==t))))}else v.A.error(n)},R=()=>S(!0);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",Object.assign({className:"card"},{children:[(0,n.jsx)("div",Object.assign({className:"card-header"},{children:(0,n.jsx)("input",{type:"text",className:"form-control",placeholder:(0,u.t)("user.typeToSearch"),onChange:e=>{N(e.target.value)}},void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:"card-body p-0 table-responsive"},{children:(0,n.jsxs)("table",Object.assign({className:"table table-hover"},{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",Object.assign({style:{width:"12%"}},{children:"PID"}),void 0),(0,n.jsx)("th",{children:(0,u.t)("general.player.player-name")},void 0),(0,n.jsx)("th",Object.assign({style:{width:"50%"}},{children:(0,u.t)("user.player.operation")}),void 0)]},void 0)},void 0),(0,n.jsx)("tbody",{children:t?new Array(Z).fill(null).map(((e,s)=>(0,n.jsx)(k,{},s))):0===e.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",Object.assign({className:"text-center",colSpan:3},{children:(0,u.t)("general.noResult")}),void 0)},void 0):e.filter((({name:e})=>e.includes(y))).map(((e,t)=>(0,n.jsx)(g,{player:e,selected:j===e.pid,onClick:()=>A(e),onEditName:()=>(async(e,t)=>{let n;try{const{value:s}=await(0,v.K)({mode:"prompt",text:(0,u.t)("user.changePlayerName"),input:e.name,validator:e=>{if(!e)return(0,u.t)("user.emptyPlayerName")}});n=s}catch(e){return}const{code:a,message:i}=await l.gz(h.Z.user.player.rename(e.pid),{name:n});0===a?(v.A.success(i),s((s=>(s[t]=Object.assign(Object.assign({},e),{name:n}),s.slice())))):v.A.error(i)})(e,t),onReset:R,onDelete:_},e.pid)))},void 0)]}),void 0)}),void 0),(0,n.jsx)("div",Object.assign({className:"card-footer"},{children:(0,n.jsxs)("button",Object.assign({className:"btn btn-primary",onClick:()=>w(!0)},{children:[(0,n.jsx)("i",{className:"fas fa-plus mr-1"},void 0),(0,n.jsx)("span",{children:(0,u.t)("user.player.add-player")},void 0)]}),void 0)}),void 0)]}),void 0),(0,n.jsx)(P,{skin:m.url,cape:b.url,isAlex:m.type===d.N.Alex},void 0),(0,n.jsx)(E,{show:O,onAdd:e=>{s((s=>[...s,e]))},onClose:()=>w(!1)},void 0),(0,n.jsx)(B,{show:C,onSubmit:async(e,t)=>{if(!e&&!t)return void v.A.warning((0,u.t)("user.noClearChoice"));const n=new URLSearchParams;e&&n.append("skin","true"),t&&n.append("cape","true");const{code:a,message:i}=await l.IV(`${h.Z.user.player.clear(j)}?${n.toString()}`);0===a?(v.A.success(i),e&&x(0),t&&f(0),s((s=>{const n=s.findIndex((e=>e.pid===j)),a=Object.assign({},s[n]);return e&&(a.tid_skin=0),t&&(a.tid_cape=0),s[n]=a,s.slice()}))):v.A.error(i)},onClose:()=>S(!1)},void 0)]},void 0)}))}}]);